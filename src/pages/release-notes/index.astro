---
import Layout from "../../layouts/Layout.astro";
import { getCollection, getEntry } from "astro:content";
import Markdown from "@astrojs/markdown-component";

const allReleases = await getCollection("releases");

import { dateToFormat } from "../../helpers/dateToFormat";
const { entry } = Astro.props;
---

<Layout>
  <main class="py-20">
    <article class="container">
      <header class="mb-12">
        <h2 class="text-white font-semibold text-3xl lg:text-4xl mb-6">
          Release notes
        </h2>
      </header>

      <div class="flex gap-16 min-h-full">
        {
          allReleases.map(async (note) => {
            return (
              <>
                <div class="flex-1 w-1/3 border-l border-gray-700">
                  <div class="sticky top-4">
                    <div class="relative pl-6">
                      <div class="absolute -left-2 top-[6px] w-4 h-4 rounded-full bg-gray-700 border border-gray-500" />
                      <div class="text-lg text-gray-100">{note.data.title}</div>
                      <div>{dateToFormat(note.data.publishDate)}</div>
                    </div>
                  </div>
                </div>
                <div class="w-2/3">
                  <div class="[&:not(:first-child)]:mt-12">
                    <h3 class="mb-12 text-white text-2xl font-semibold">
                      {note.data.title}
                    </h3>
                    {note.data.image && (
                      <div class="h-96 my-4 border border-gray-700 rounded-lg overflow-hidden">
                        <img
                          class="w-full h-full object-cover"
                          src={`/blog/${note.data.image.src}/`}
                          alt={note.data.image.alt}
                        />
                      </div>
                    )}
                  </div>
                  <div class="prose  xl:prose-lg prose-headings:text-gray-200 prose-a:text-gray-100 prose-ul:text-gray-300 prose-ol:text-gray-300 prose-strong:text-gray-200 prose-p:text-gray-300">
                    <Markdown>{note.body}</Markdown>
                  </div>
                  <div />
                </div>
              </>
            );
          })
        }
      </div>
    </article>
  </main>
</Layout>
